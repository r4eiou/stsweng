<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>
<script src="/js/sweetalert.min.js"></script>
<script src="/js/webcam.min.js"></script>
<script src="/js/print.js"></script>
<script src="/js/header.js"></script>

<link rel="stylesheet" type="text/css" href="/css/index.css" />
<link rel="stylesheet" type="text/css" href="/css/back-button.css" />
<link rel="stylesheet" type="text/css" href="/css/input-details-page.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous" />

<div class="main-container">
  <div class="header" id="header">
    <div class="header-left">
      <a href="/index" class="header-logo-link" id="home-link1"><img src="/images/logo.png" class="header-logo" /></a>
      <a href="/index" class="header-home" id="home-link2"><p class="leftTitle">Home</p></a>
    </div>

    {{! <div class = "">
            <div class = "header-text">
                <h3>Sangguniang Barangay ng Parang</h3>
                <h5>Marikina City</h5>
            </div>
        </div> }}

    <div class="midHeader text-center">
      <p class="title">Sangguniang Barangay ng Parang</p>
      <p class="title-place">Marikina City</p>
    </div>

    <div class="header-right">
      <div class="header-user-profile">
        <span class="header-user-profile-text" id="profile-text">Employee</span>
        <img src="/images/employee-profile.png" class="header-user-profile" id="profile-img" />
      </div>
      <button type="button" class="header-logout-btn" id="logout-btn">Logout</button>
    </div>
  </div>
</div>
<div class="upper-container" id="form-upper-container">
  <div class="back-and-title">
    <a href="/events-db-view" class="back-button" id="white-back-button">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="white" class="size-4">
        <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8Zm10.25.75a.75.75 0 0 0 0-1.5H6.56l1.22-1.22a.75.75 0 0 0-1.06-1.06l-2.5 2.5a.75.75 0 0 0 0 1.06l2.5 2.5a.75.75 0 1 0 1.06-1.06L6.56 8.75h4.69Z" clip-rule="evenodd" />
      </svg>
      Back
    </a>
  </div>
</div>

<div class="d-flex flex-column">
  <h1 id="crud-event-title">Creating a New Event</h1>

  <form action="#" method="post" class="event-form">
    <input type="hidden" name="_id" value="{{events._id}}" id="_id" />

    <div class="events-panel container bg-white">
      <!-- for Photo-->
      <div class="row text-center">
        <div class="col">
          <img src="/images/empty-img.png" class="details-profile" id="deets-profile-img" />
          <button type="button" class="image-upload-button" id="accesscamera" data-toggle="modal" data-target="#photoModal">Capture Photo</button>
          <!-- Modal for Webcam -->
          <div class="modal fade" id="photoModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Capture Photo</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="width: fit-content;">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <div id="my_camera" class="d-block mx-auto rounded overflow-hidden"></div>
                  <div id="results" class="d-none"></div>
                  <form method="post" id="photoForm">
                    <input type="hidden" id="photoStore" name="photoStore" value="" />
                  </form>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-warning mx-auto text-white" id="takephoto">Capture Photo</button>
                  <button type="button" class="btn btn-warning mx-auto text-white d-none" id="retakephoto">Retake</button>
                  <button type="button" class="btn btn-warning mx-auto text-white d-none" id="uploadphoto">Upload</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col m-3">
          <label for="headline-event" class="form-label">Headline</label>
          <input type="email" class="form-control p-0" id="headline-event" />
        </div>
      </div>

      <div class="row">
        <div class="col m-3">
          <label for="start-event" class="form-label">Start Date</label>
          <input type="date" class="form-control p-0" id="start-event" />
        </div>
        <div class="col m-3">
          <label for="end-event" class="form-label">End Date</label>
          <input type="date" class="form-control p-0" id="end-event" />
        </div>
      </div>

      <div class="row">
        <div class="col m-3">
          <label for="details-event" class="form-label">Details</label>
          <textarea rows="3" class="form-control p-0" style="resize: none;"></textarea>
        </div>
      </div>

    </div>

    <div class="d-flex flex-column g-3 mx-auto">
      <div class="row">
        <div class="col"><button type="button" class="form-btn save cert" onclick="#"><img src="/images/form-check.png" /><span>Save Changes</span></button></div>
        <button type="button" class="form-btn delete cert" onclick="goBack()"><img src="/images/form-trash.png" /><span>Discard Changes</span></button>
        <div class="col"></div>
      </div>

    </div>
  </form>
</div>

<div id="validationModal" class="modal">
  <div class="modal-content">
    {{! <span class="close">&times;</span> }}
    <p id="modalMessage"></p>
  </div>
</div>

<script>
  const { jsPDF } = window.jspdf; function titleCase(str) { return str.toLowerCase().split(' ').map(function(word) { return word.replace(word.charAt(0), word.charAt(0).toUpperCase()); }).join(' '); } function goBack () { const form = document.querySelector('.print-form'); const _id =
  form.elements['_id'].value; window.location.href=`/certificate-view/${_id}`; } async function downloadFileEmployee() { // Perform validation const isValid = await validateFormEdit(); // If validation fails, exit the function if (!isValid) { return; } const form =
  document.querySelector('.print-form'); const _id = form.elements['_id'].value; const name = titleCase(form.elements['name'].value); const birthday = formatBirthday(form.elements['bday-date'].value); const address = titleCase(form.elements['address'].value); const ctcDateIssued =
  formatBirthday(form.elements['ctc-date'].value); const location = titleCase(form.elements['location'].value); const cedula = form.elements['cedula'].value; const birthPlace = titleCase(form.elements['birthplace'].value); const reason = form.elements['reason'].value.toUpperCase(); const profileImg
  = document.getElementById('deets-profile-img').src; const today = new Date(); const yyyy = today.getFullYear(); const mm = String(today.getMonth() + 1).padStart(2, '0'); // January is 0! const dd = String(today.getDate()).padStart(2, '0'); const formattedDate = `${yyyy}-${mm}-${dd}`; const
  certDateIssued = formatBirthday(formattedDate); //send data const data = { _id, name, birthday:form.elements['bday-date'].value, address, ctc_no: cedula, ctc_date_issued: form.elements['ctc-date'].value, ctc_location: location, cert_date_issued: formattedDate, reason, img: profileImg };
  console.log(JSON.stringify(data)); fetch('/submit-edit-certificate', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) }) .then(response => response.json()) .then(result => { window.location.href=`/certificate-view/${_id}`; }) .catch(error => {
  console.log("error here fetch") console.error('Error:', error); }); }

</script>