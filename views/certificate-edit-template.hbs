<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>
<script src="/js/sweetalert.min.js"></script>
<script src="/js/webcam.min.js"></script>
<script src="/js/print.js"></script>
<script src ="/js/header.js"></script>

<link rel = "stylesheet" type = "text/css" href = "/css/index.css">
<link rel = "stylesheet" type = "text/css" href = "/css/back-button.css">
<link rel = "stylesheet" type = "text/css" href = "/css/input-details-page.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">

<div class="main-container" id="main-container">
    <div class= "header" id="header">
        <div class = "header-left">
            <a href="/index" class="header-logo-link" id="home-link1"><img src="/images/logo.png" class="header-logo"></a>
            <a href="/index" class="header-home" id="home-link2"><p class="leftTitle">Home</p></a>
        </div>
        
        <div class="midHeader">
            <p class="title">Sangguniang Barangay ng Parang</p>
            <p class="title-place" >Marikina City</p>
        </div>
        
        
        <div class="header-right">
            <div class="header-user-profile">
                <span class="header-user-profile-text" id="profile-text">Employee</span>
                <img src="/images/employee-profile.png" class="header-user-profile" id="profile-img">
            </div>
            <button type="button" class="header-logout-btn" id="logout-btn">Logout</button>
        </div>
    </div>
    
     <div class = "upper-container" id="form-upper-container">
        <div class="back-and-title">
            <a href="/certificate-db" class="back-button" id="white-back-button">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="white" class="size-4">
                    <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8Zm10.25.75a.75.75 0 0 0 0-1.5H6.56l1.22-1.22a.75.75 0 0 0-1.06-1.06l-2.5 2.5a.75.75 0 0 0 0 1.06l2.5 2.5a.75.75 0 1 0 1.06-1.06L6.56 8.75h4.69Z" clip-rule="evenodd"/>
                </svg>
                Back
            </a>
        </div>
    </div>

    <div class="sub-container">
        <div class = "edit-cert-template-header">
            Editing Certificate Template Details
        </div>

        <form action="/submit-edit-certificateInfo" method="post" class="print-form">   
            <div class = "edit-cert-template-panel">
                <!-- for Photo-->
                <div class="deets-text">Header Logo</div>
                <div class="photo-container">
                    <img src="{{certificateInfo.img}}" class="details-profile" id="header-logo-img">
                    <label for="photo-upload" class="image-upload-button">Upload Photo</label>
                    <input type="file" 
                        id="photo-upload" 
                        accept="image/*"
                        style="display: none;",
                        onchange="convertToDataURL(this)">

                    <input type="hidden" id="hidden-img-base64" name="img">
                </div>
                
                <!-- for New Barangay Captain Name -->
                <div class="deets2-container">
                    <div class="address-container">
                        <div class="deets-text">Barangay Captain</div>
                        <input type="text" id="brgy-captain-name" name="brgy_captain_name" placeholder="{{certificateInfo.brgy_capt_name}}" value="" style="text-transform: uppercase;">
                    </div>
                </div>

                <!-- for New Slogan -->
                <div class="deets2-container">
                    <div class="address-container">
                        <div class="deets-text">Slogan</div>
                        <input type="text" id="slogan" name="slogan" placeholder="{{certificateInfo.slogan}}" value="">
                    </div>
                </div>

                <!--
                <div class="action-container">
                    {{!-- <button type="button" class="download-btn lrg dark" onclick="downloadFileEmployee()"><img src="/images/download-dark.png"><span>Download</span></button> --}}
                    {{!-- <button type="button" class="cancel-btn light" onclick="cancelForm()"><img src="/images/cancel-light.png"><span>Cancel</span></button> --}}
                    <button type="button" id="saveButton"       class="form-btn save" onclick="downloadFileEmployee()">      <img src="/images/form-check.png"><span>Save Changes</span></button>
                    <button type="button" id="discardButton"    class="form-btn discard" onclick="goBack()">   <img src="/images/form-trash.png"><span>Discard Changes</span></button>
                </div>
                -->
            </div>
            <div class="cert-buttons-container">
                    {{!-- <button type="button" class="download-btn lrg dark" onclick="downloadFileEmployee()"><img src="/images/download-dark.png"><span>Download</span></button> --}}
                    {{!-- <button type="button" class="cancel-btn light" onclick="cancelForm()"><img src="/images/cancel-light.png"><span>Cancel</span></button> --}}
                    
                    <button type="button" class="form-btn save cert" id="submitBtn"><img src="/images/form-check.png"><span>Save Changes</span></button>
                    <a href="/certificate-edit-template">
                        <button type="button" class="form-btn delete cert"><img src="/images/form-trash.png"><span>Discard Changes</span></button>
                    </a>
                </div>
        </form>
    </div>

</div>

<div id="validationModal" class="modal">
    <div class="modal-content">
        {{!-- <span class="close">&times;</span> --}}
        <p id="modalMessage"></p>
    </div>
</div>

<script>
    function convertToDataURL(input) {
        const file = input.files[0];
        
        if (file) {
            const reader = new FileReader();
            
            reader.onloadend = function() {
                // The result is the base64-encoded image data
                document.getElementById('header-logo-img').src = reader.result;

                // Set the value of the hidden input field to the Base64 string
                document.getElementById('hidden-img-base64').value = reader.result;
            };
            
            reader.readAsDataURL(file); // Converts the image to base64
        }
    }

    function titleCase(str) {
        return str.toLowerCase().split(' ').map(function(word) {
            return word.replace(word.charAt(0), word.charAt(0).toUpperCase());
        }).join(' ');
    }

    function checkChanges() {
        // Get all input fields
        let inputs = document.querySelectorAll('input[type="text"], textarea');

        // Loop through each input field
        inputs.forEach(input => {
            // Check if the input field value is different from its placeholder
            if (input.value === "") {
                input.value = input.placeholder; // If value is empty, restore the placeholder
            }
        });
    }

    const submitButton = document.getElementById('submitBtn');
    if (submitButton) {
        submitButton.addEventListener('click', function () {

            console.log("checking submitBtn")

            checkChanges();
            const form = document.querySelector('.print-form');
            form.submit();
        });
    }


</script>
